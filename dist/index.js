!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}return t.createContentItem=function(t,e,n){void 0===n&&(n=null);var o=document.createElement("div");return n?o.insertAdjacentHTML("beforeend",'<img src="'+n+'" alt="'+(e||"")+'" style="max-width: 100%;max-height: calc(100% - 19px);">'):o.insertAdjacentHTML("beforeend",'<img src="'+t.imgFolder+'" alt="'+(e||"")+'">'),o.insertAdjacentHTML("beforeend",'<p style="margin: 5px 0 10px;white-space: nowrap;text-overflow: ellipsis;overflow: hidden;font-size: 11px;">'+(e||"")+"</p>"),o.style.width="10%",o.style.maxWidth="100px",o.style.height="70px",o.style.textAlign="center",o.style.margin="5px",o.style.cursor="pointer",o.id=Date.now().toString(),o},t}();e.Utils=o},function(t,e,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2);e.ImageManager=i.ImageManager;var r=n(0);e.Utils=r.Utils,e.default=grapesjs.plugins.add("gjs-image-manager",function(t,e){void 0===e&&(e={});var n=o({url:null,credentials:"include",beforeSend:null,beforeSetSrc:function(t){return t},afterChoosingRunOpenAssets:!1,headers:{},params:{},queryKey:"path",modalTitle:"File Explorer",btnText:"Explorer images",textEmptyFolder:"Empty folder",imgLoader:"data:image/svg+xml,%3Csvg width='38' height='38' viewBox='0 0 38 38' xmlns='http://www.w3.org/2000/svg' stroke='%23fff'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(1 1)' stroke-width='2'%3E%3Ccircle stroke-opacity='.5' cx='18' cy='18' r='18'/%3E%3Cpath d='M36 18c0-9.94-8.06-18-18-18'%3E%3CanimateTransform attributeName='transform' type='rotate' from='0 18 18' to='360 18 18' dur='1s' repeatCount='indefinite'/%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/svg%3E",imgFolder:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='35' height='35' viewBox='0 0 24 24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath fill='#ffffff' d='M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z'/%3E%3C/svg%3E",imgHome:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 24 24'%3E%3Cpath fill='#ffffff' d='M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E",imgReply:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 24 24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath fill='#ffffff' d='M21 11H6.83l3.58-3.59L9 6l-6 6 6 6 1.41-1.41L6.83 13H21z'/%3E%3C/svg%3E",imgChevronRight:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 24 24'%3E%3Cpath fill='#ffffff' d='M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E"},e);t.on("load",function(){});var r=t.getConfig("stylePrefix"),s=t.AssetManager,a=new i.ImageManager(n);t.ImageExplorer=a,t.on("run:open-assets",function(e){if(!s.getContainer().querySelector("."+r+"btn-explorer-images")){var o=document.createElement("button");o.classList.add(r+"btn-prim"),o.classList.add(r+"btn-explorer-images"),o.onclick=function(){return a.open(t)},o.textContent=n.btnText,o.style.width="100%",s.getContainer().insertAdjacentElement("beforeend",o)}})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(){function t(t){void 0===t&&(t={}),this.options=t,this.requestHeader="X-Requested-With",this.breadcrumb=document.createElement("div"),this.modalContent=document.createElement("div"),this.loader=document.createElement("img"),this.loader.src=this.options.imgLoader,this.loader.style.position="absolute",this.loader.style.left="calc(50% - 38px)",this.loader.style.top="calc(50% - 25px)"}return t.prototype.open=function(t){var e=this;this.modal||(this.modal=t.Modal,this.modal.setTitle(this.options.modalTitle),this.breadcrumb.style.fontSize="10px",this.breadcrumb.style.display="flex",this.breadcrumb.style.alignItems="center",this.breadcrumb.style.cursor="pointer",this.breadcrumb.style.padding="0 10px 5px",this.breadcrumb.style.borderBottom="1px solid rgba(0,0,0,0.2)",this.modalContent.classList.add("content"),this.modalContent.style.minHeight="50px",this.modalContent.style.display="flex",this.modalContent.style.flexWrap="wrap"),this.editor=t,t.Commands.isActive("open-assets")&&t.Commands.stop("open-assets"),this.modal.isOpen()&&this.modal.close();var n=document.createElement("div");n.style.position="relative",n.style.padding="0 0 10px",n.append(this.breadcrumb),n.append(this.modalContent),n.append(this.loader),this.modal.open({content:n}),this.fetch("").then(function(t){e.setContent(t)}).catch(function(t){console.log(t)})},t.prototype.selectItem=function(t,e){var n=this;if(void 0===e&&(e=!0),e)this.fetch(t).then(function(t){n.setContent(t)}).catch(function(t){console.log(t)});else{var o=this.editor.getSelected();this.editor.AssetManager.get("http://binotel.local/"+t)||this.editor.AssetManager.add("http://binotel.local/"+t),o&&("image"===o.get("type")?o.set("src",this.getImageSrc(t)):o.setStyle({"background-image":"url("+this.getImageSrc(t)+")"}),this.modal.close(),this.options.afterChoosingRunOpenAssets&&this.editor.runCommand("open-assets"))}},t.prototype.setContent=function(t){var e=this;void 0===t&&(t={}),t?(t.directories||[]).reduce(function(t,n){return t.then(function(){var t=n.split("/").pop()||"",i=o.Utils.createContentItem(e.options,t);return i.onclick=function(){return e.selectItem(n)},e.modalContent.appendChild(i)})},Promise.resolve()).then(function(n){(t.files||[]).reduce(function(t,n){return t.then(function(){var t=n.split("/").pop()||"",i=o.Utils.createContentItem(e.options,t,e.getImageSrc(n));return i.onclick=function(){return e.selectItem(n,!1)},e.modalContent.appendChild(i)})},Promise.resolve()).then(function(t){n||t||e.modalContent.insertAdjacentHTML("beforeend","<p>"+e.options.textEmptyFolder+"</p>")})}):this.modalContent.insertAdjacentHTML("beforeend","<p>Wrong answer</p>")},t.prototype.getImageSrc=function(t){var e=t;if("function"==typeof this.options.beforeSetSrc)try{e=this.options.beforeSetSrc(t)}catch(t){console.log(t)}return e},t.prototype.fetch=function(t){var e=this;void 0===t&&(t=""),this.loader.hidden=!1;try{for(;this.modalContent.firstChild;)this.modalContent.removeChild(this.modalContent.firstChild)}catch(t){console.log(t)}var n=t||"";if("function"==typeof this.options.beforeSend)try{t=this.options.beforeSend(t)}catch(t){throw this.loader.hidden=!0,new Error("Error function beforeSend()")}var o=t.split("/").slice(0,-1).join(' <img src="'+this.options.imgChevronRight+'"> ');if(o.length?this.breadcrumb.innerHTML='<img src="'+this.options.imgReply+'"> '+o:this.breadcrumb.innerHTML='<img src="'+this.options.imgHome+'">',this.breadcrumb.onclick=function(){return e.selectItem(n.split("/").slice(0,-1).join("/"))},!this.options.url||"string"!=typeof this.options.url)throw this.loader.hidden=!0,new Error("Unknown options url");var i,r=new URL(this.options.url),s=this.options.headers;for(i in s[this.requestHeader]||(s[this.requestHeader]="XMLHttpRequest"),this.options.params)r.searchParams.append(i,this.options.params[i]);return r.searchParams.append(this.options.queryKey,t),fetch(r.toString(),{method:"GET",credentials:this.options.credentials,headers:s}).then(function(t){if(setTimeout(function(){e.loader.hidden=!0},200),1==(t.status/200|0)){var n=void 0;try{n=t.json()}catch(e){n=t.text().then(function(t){return Promise.reject(t)})}return n}return t.text().then(function(t){return Promise.reject(t)})}).catch(function(t){return setTimeout(function(){e.loader.hidden=!0},200),t})},t}();e.ImageManager=i}])});
//# sourceMappingURL=index.js.map